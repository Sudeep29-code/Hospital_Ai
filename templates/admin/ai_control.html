<!DOCTYPE html>
<html>
<head>
    <title>AI Control Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <style>
        :root {
            --teal:         #00bbcc;
            --teal-dark:    #009aab;
            --teal-darker:  #007a88;
            --teal-soft:    rgba(0, 187, 204, 0.10);
            --teal-glow:    rgba(0, 187, 204, 0.30);
            --teal-border:  rgba(0, 187, 204, 0.22);
            --grad-primary: linear-gradient(135deg, #00bbcc 0%, #00e5c8 100%);
            --grad-deep:    linear-gradient(135deg, #007a88 0%, #00bbcc 100%);
            --grad-warm:    linear-gradient(135deg, #f59e0b 0%, #f97316 100%);

            --amber:        #f59e0b;
            --amber-soft:   rgba(245, 158, 11, 0.10);
            --amber-glow:   rgba(245, 158, 11, 0.22);

            --emerald:      #10b981;
            --emerald-soft: rgba(16, 185, 129, 0.10);
            --emerald-glow: rgba(16, 185, 129, 0.25);

            --indigo:       #6366f1;
            --indigo-soft:  rgba(99, 102, 241, 0.10);

            --bg-main:      #f0fbfc;
            --bg-wash:      #e6f8fa;
            --card-bg:      #ffffff;
            --glass-bg:     rgba(255,255,255,0.82);

            --text-main:    #071e22;
            --text-sub:     #1a3d42;
            --text-muted:   #7a9fa5;
            --text-light:   #b8d4d8;

            --border:       #d4eef1;
            --border-strong:#b0dde3;

            --shadow-soft:  0 4px 24px rgba(0, 100, 110, 0.08);
            --shadow-teal:  0 8px 28px rgba(0, 187, 204, 0.28);

            --radius-sm: 10px;
            --radius:    14px;
            --radius-lg: 22px;
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: "Outfit", sans-serif;
            background: var(--bg-main);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px 16px;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background:
                radial-gradient(ellipse 65% 55% at 90% 5%,  rgba(0,187,204,0.09) 0%, transparent 60%),
                radial-gradient(ellipse 50% 45% at 5%  90%,  rgba(0,229,200,0.07) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        /* ── Card ── */
        .form-card {
            background: var(--card-bg);
            width: 100%;
            max-width: 520px;
            border-radius: var(--radius-lg);
            border: 1.5px solid var(--border);
            box-shadow: var(--shadow-soft);
            overflow: hidden;
            position: relative;
            z-index: 1;
            animation: fadeUp 0.45s ease both;
        }

        @keyframes fadeUp {
            from { opacity: 0; transform: translateY(16px); }
            to   { opacity: 1; transform: translateY(0); }
        }

        .form-card::before {
            content: '';
            display: block;
            height: 4px;
            background: var(--grad-primary);
        }

        /* ── Header ── */
        .card-header {
            padding: 24px 32px 20px;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            gap: 14px;
        }

        .card-header-icon {
            width: 46px;
            height: 46px;
            background: var(--grad-primary);
            border-radius: 13px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 19px;
            color: #fff;
            box-shadow: 0 6px 18px var(--teal-glow);
            flex-shrink: 0;
        }

        .card-header-text h2 {
            font-family: "Syne", sans-serif;
            font-size: 18px;
            font-weight: 800;
            letter-spacing: -0.3px;
            color: var(--text-main);
        }

        .card-header-text p {
            font-size: 11.5px;
            color: var(--text-muted);
            margin-top: 2px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* ── Body ── */
        .card-body {
            padding: 26px 32px 8px;
        }

        /* Section label */
        .form-section-label {
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1.4px;
            text-transform: uppercase;
            color: var(--text-light);
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-section-label::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--border);
        }

        /* Two-column grid for settings */
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 10px;
        }

        .form-group { margin-bottom: 0; }

        label {
            display: block;
            font-weight: 700;
            font-size: 11.5px;
            margin-bottom: 7px;
            color: var(--text-sub);
            text-transform: uppercase;
            letter-spacing: 0.7px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Input with icon */
        .input-wrap {
            position: relative;
        }

        .input-wrap .input-icon {
            position: absolute;
            left: 11px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            font-size: 12px;
            pointer-events: none;
        }

        input {
            width: 100%;
            padding: 9px 12px 9px 32px;
            border-radius: var(--radius-sm);
            border: 1.5px solid var(--border);
            background: var(--bg-wash);
            font-size: 14px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-main);
            transition: all 0.2s ease;
            outline: none;
            font-weight: 600;
        }

        input:focus {
            border-color: var(--teal);
            background: #fff;
            box-shadow: 0 0 0 3px var(--teal-soft);
        }

        /* Range slider hint */
        .field-hint {
            font-size: 10.5px;
            color: var(--text-muted);
            margin-top: 5px;
            font-family: 'JetBrains Mono', monospace;
        }

        /* Info cards for context */
        .info-banner {
            background: var(--teal-soft);
            border: 1.5px solid var(--teal-border);
            border-radius: var(--radius-sm);
            padding: 12px 16px;
            margin-bottom: 22px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            font-size: 12.5px;
            color: var(--teal-darker);
            line-height: 1.5;
        }

        .info-banner i { margin-top: 1px; flex-shrink: 0; }

        /* Weight indicator bar */
        .weight-bar-wrap {
            margin-top: 20px;
            margin-bottom: 6px;
            background: var(--bg-wash);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 14px 16px;
        }

        .weight-bar-label {
            font-size: 10.5px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
            margin-bottom: 10px;
        }

        .weight-bar {
            display: flex;
            height: 8px;
            border-radius: 99px;
            overflow: hidden;
            gap: 2px;
        }

        .weight-bar-seg {
            border-radius: 99px;
            transition: flex 0.4s ease;
        }

        .seg-fairness { background: var(--grad-primary); flex: 5; }
        .seg-wait     { background: var(--grad-warm);    flex: 5; }

        .weight-legend {
            display: flex;
            gap: 18px;
            margin-top: 8px;
        }

        .wl-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 11px;
            color: var(--text-muted);
            font-family: 'JetBrains Mono', monospace;
        }

        .wl-dot {
            width: 8px; height: 8px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .wl-dot.teal   { background: var(--teal); }
        .wl-dot.amber  { background: var(--amber); }

        /* ── Footer Buttons ── */
        .card-footer {
            padding: 18px 32px 28px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn {
            width: 100%;
            padding: 11px 20px;
            border: 1.5px solid transparent;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 14px;
            font-weight: 700;
            font-family: "Outfit", sans-serif;
            letter-spacing: 0.2px;
            transition: all 0.22s cubic-bezier(0.34, 1.56, 0.64, 1);
            text-decoration: none;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        .btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.16) 0%, transparent 100%);
            pointer-events: none;
        }

        .btn-primary {
            background: var(--grad-primary);
            color: #fff;
            box-shadow: 0 4px 16px var(--teal-glow);
        }

        .btn-primary:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: var(--shadow-teal);
        }

        .btn-back {
            background: var(--card-bg);
            color: var(--text-muted);
            border-color: var(--border-strong);
        }

        .btn-back:hover {
            border-color: var(--teal);
            color: var(--teal-dark);
            background: var(--teal-soft);
            transform: translateY(-2px);
        }
    </style>
</head>

<body>

<div class="form-card">

    <!-- Header -->
    <div class="card-header">
        <div class="card-header-icon">
            <i class="fa-solid fa-sliders"></i>
        </div>
        <div class="card-header-text">
            <h2>AI Control Panel</h2>
            <p>Tune the assignment engine parameters</p>
        </div>
    </div>

    <!-- Body -->
    <div class="card-body">

        <div class="info-banner">
            <i class="fa-solid fa-circle-info"></i>
            Weights must balance between 0.0 and 1.0. Higher fairness weight prioritises equal distribution; higher wait weight prioritises queue speed.
        </div>

        <form method="POST" id="aiForm">

            <!-- Weight Parameters -->
            <div class="form-section-label">Assignment Weights</div>

            <div class="settings-grid">
                <div class="form-group">
                    <label>Fairness Weight</label>
                    <div class="input-wrap">
                        <i class="fa-solid fa-scale-balanced input-icon"></i>
                        <input type="number" step="0.1" min="0" max="1"
                               name="fairness_weight"
                               value="{{ settings.fairness_weight }}"
                               id="fairnessInput">
                    </div>
                    <div class="field-hint">Range: 0.0 – 1.0</div>
                </div>

                <div class="form-group">
                    <label>Wait Time Weight</label>
                    <div class="input-wrap">
                        <i class="fa-solid fa-clock input-icon"></i>
                        <input type="number" step="0.1" min="0" max="1"
                               name="wait_weight"
                               value="{{ settings.wait_weight }}"
                               id="waitInput">
                    </div>
                    <div class="field-hint">Range: 0.0 – 1.0</div>
                </div>
            </div>

            <!-- Visual weight bar -->
            <div class="weight-bar-wrap">
                <div class="weight-bar-label">Weight Balance Preview</div>
                <div class="weight-bar">
                    <div class="weight-bar-seg seg-fairness" id="barFairness"></div>
                    <div class="weight-bar-seg seg-wait"     id="barWait"></div>
                </div>
                <div class="weight-legend">
                    <div class="wl-item"><div class="wl-dot teal"></div>Fairness</div>
                    <div class="wl-item"><div class="wl-dot amber"></div>Wait Time</div>
                </div>
            </div>

            <!-- Threshold Parameters -->
            <div class="form-section-label" style="margin-top:22px;">Threshold Settings</div>

            <div class="settings-grid" style="margin-bottom:6px;">
                <div class="form-group">
                    <label>Overload Threshold</label>
                    <div class="input-wrap">
                        <i class="fa-solid fa-triangle-exclamation input-icon"></i>
                        <input type="number"
                               name="overload_threshold"
                               value="{{ settings.overload_threshold }}">
                    </div>
                    <div class="field-hint">Max patients per doctor</div>
                </div>

                <div class="form-group">
                    <label>Cooldown Minutes</label>
                    <div class="input-wrap">
                        <i class="fa-solid fa-hourglass-half input-icon"></i>
                        <input type="number"
                               name="cooldown_minutes"
                               value="{{ settings.cooldown_minutes }}">
                    </div>
                    <div class="field-hint">Re-assignment delay</div>
                </div>
            </div>

        </form>
    </div>

    <!-- Footer -->
    <div class="card-footer">
        <button type="submit" form="aiForm" class="btn btn-primary">
            <i class="fa-solid fa-floppy-disk"></i>
            Update AI Settings
        </button>
        <a href="/admin/dashboard" class="btn btn-back">
            ← Back to Dashboard
        </a>
    </div>

</div>

<script>
    // Live weight bar
    const fInput = document.getElementById('fairnessInput');
    const wInput = document.getElementById('waitInput');
    const barF   = document.getElementById('barFairness');
    const barW   = document.getElementById('barWait');

    function updateBar() {
        const f = parseFloat(fInput.value) || 0;
        const w = parseFloat(wInput.value) || 0;
        const total = f + w || 1;
        barF.style.flex = f / total * 10;
        barW.style.flex = w / total * 10;
    }

    fInput.addEventListener('input', updateBar);
    wInput.addEventListener('input', updateBar);
    updateBar();
</script>

</body>
</html>